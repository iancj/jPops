jQuery.jPops={conf:{title:"\u63d0\u793a",content:"\u5185\u5bb9",width:400,height:"auto",minHeight:130,minWidth:"auto",okButton:"\u786e\u5b9a",cancelButton:"\u53d6\u6d88",verticalOffset:0,horizontalOffset:0,overlayOpacity:0.5,overlayColor:"#000",callback:null},alert:function(a){var b=$.extend({},this.conf,a);b.type="alert";this.showAlerts(b)},confirm:function(a){var b=$.extend({},this.conf,a);b.type="confirm";this.showAlerts(b)},prompt:function(a){this.conf.defaultValue="";var b=$.extend({},this.conf,a);b.type="prompt";this.showAlerts(b)},message:function(a){this.conf.messageType="info";this.conf.messageTimging=1500;this.conf.messageAutoHide=true;var b=$.extend({},this.conf,a);b.type="message";this.showAlerts(b)},progress:function(c){if(this.timer){clearTimeout(this.timer)}this.conf.width=500;this.conf.progressPer=10;this.conf.progressType="";this.conf.progressActived=false;var f=$.extend({},this.conf,c);f.type="progress";if($(".popup-progress").length!=1){var d='<div class="popup-progress"><h4 class="content"></h4>';if(f.progressActived){d+='<div class="progress progress-striped active">'}else{d+='<div class="progress">'}d+='<div class="bar"></div></div></div>';$("body").append(d)}var b=$(".popup-progress"),h=b.find(".content"),e=b.find(".progress"),a=b.find(".bar"),g=($.browser.msie&&parseInt($.browser.version)<=6)?"absolute":"fixed";h.text(f.content);a.css("width",f.progressPer+"%").removeClass("bar-info bar-warning bar-success bar-danger").addClass("bar-"+f.progressType);if(f.progressActived){e.addClass("progress-striped active")}else{e.removeClass("progress-striped active")}b.show().css({width:f.width,top:150,left:"50%",textAlign:"center",position:g,zIndex:99999});this.reposition(f);this.showOverlay(f)},progressUpdate:function(e){var b=$(".popup-progress"),a=b.find(".content"),d=b.find(".progress"),c=d.find(".bar");var f=$.extend({},this.conf,e);f.type="progress";f.width=e.width;for(key in e){switch(key){case"content":a.text(f.content);break;case"progressPer":c.css("width",f.progressPer+"%");break;case"progressType":c.removeClass("bar-info bar-warning bar-success bar-danger").addClass("bar-"+f.progressType);break;case"progressActived":if(f.progressActived){d.removeClass("progress-striped active")}else{d.addClass("progress-striped active")}case"callback":if(f.callback){f.callback(true);f.callback=null}}}},progressHide:function(){$(".popup-progress").hide().css("width","auto");this.hideOverlay()},showAlerts:function(a){if($(".popup-container").length<1){var g='<div class="popup-container"><h1 class="popup-title"></h1><a href="javascript:;" class="popup-close"></a><div class="popup-content"><div class="popup-message"></div><div class="popup-prompt"><input type="text"></div></div><div class="popup-panel"><a href="javascript:;" class="btn btn-primary popup-ok"></a> <a href="javascript:;" class="btn popup-cancel"></a></div></div>';$("body").append(g)}this.showOverlay(a);if(this.timer){clearTimeout(this.timer)}var l=this,k=$(".popup-container"),b=k.find(".popup-title"),d=k.find(".popup-content"),h=k.find(".popup-message"),j=k.find(".popup-prompt"),e=k.find(".popup-panel"),m=k.find(".popup-ok"),f=k.find(".popup-cancel"),i=k.find(".popup-close");j.hide();e.show();switch(a.type){case"alert":f.hide();break;case"confirm":f.show();break;case"prompt":j.show();f.show();j.find("input").val(a.defaultValue).focus().select();break;case"message":e.hide();k.removeClass("info warning success danger").addClass(a.messageType);break}b.text(a.title);h.html(a.content);m.text(a.okButton);f.text(a.cancelButton);k.show().css({width:a.width,height:a.height,minWidth:a.minWidth,minHeight:a.minHeight});l.reposition(a);if(a.type!="message"){m.click(function(){if(a.callback){if(a.type=="prompt"){var n=$(".popup-container").find(".popup-prompt input").val();a.callback(n)}else{a.callback(true)}a.callback=null}l.hideAlerts();return false});f.click(function(){if(a.callback){if(a.type=="prompt"){a.callback(null)}else{a.callback(false)}a.callback=null}l.hideAlerts();return false});i.click(function(){l.hideAlerts();return false})}else{var c=function(){k.removeClass(a.messageType);i.unbind("click");if(a.callback){a.callback(true);a.callback=null}l.hideAlerts()};if(a.messageAutoHide){l.timer=setTimeout(c,a.messageTimging)}i.click(c)}},hideAlerts:function(){$(".popup-container").remove();this.hideOverlay()},showOverlay:function(a){var b=$.extend({},this.conf,a);if($(".popup-overlay").length<1){$("body").append('<div class="popup-overlay"></div>');$(".popup-overlay").css({position:"absolute",zIndex:99998,top:"0px",left:"0px",width:"100%"})}$(".popup-overlay").css({height:$(window).height(),background:b.overlayColor,opacity:b.overlayOpacity}).show();$("body").css("overflow","hidden")},hideOverlay:function(){$(".popup-overlay").hide();$("body").css("overflow","auto")},showLoading:function(a){if(a){for(key in a){switch(key){case"showOverlay":if(a[key]){this.showOverlay(a)}}}}if($(".popup-loading").length<1){var b='<div class="popup-loading" style="display:none;"></div>';$("body").append(b)}$(".popup-loading").fadeIn(300)},hideLoading:function(){$(".popup-loading").fadeOut(300);this.hideOverlay()},reposition:function(l){opts=$.extend({},this.conf,l);switch(opts.type){case"alert":case"confirm":case"message":case"prompt":var k=$(".popup-container"),c=k.find(".popup-content"),b=k.find(".popup-title"),f=k.find(".popup-panel"),a=$(window).height(),d=$(window).width(),g=k.outerHeight(),h=($.browser.msie&&parseInt($.browser.version)<=6)?"absolute":"fixed";if(k.outerHeight()>=$(window).height()){var i=$(window).height()-80-b.outerHeight()-f.outerHeight();c.css({height:i,"overflow-y":"auto"})}else{c.css({height:"auto"})}k.css({position:h,zIndex:99999});var j=(($(window).height()/2)-(k.outerHeight()/2))+opts.verticalOffset,e=(($(window).width()/2)-(k.outerWidth()/2))+opts.horizontalOffset;if(j<0){j=0}if(e<0){e=0}if($.browser.msie&&parseInt($.browser.version)<=6){j=j+$(window).scrollTop()}k.css({top:j+"px",left:e+"px"});break;case"progress":$(".popup-progress").css({marginLeft:-opts.width/2});break}$(".popup-overlay").height($(document).height())},timer:null};
